var domButton=document.getElementById("huebutton"),domOutput=document.getElementById("output"),domLocale=document.getElementById("longlat"),lightUnit=1.8,domColorvalue=document.createElement("div"),domFooter=document.querySelector(".txt-small");if(navigator.geolocation){function userFeedback(e){domOutput.textContent=e||""}function fetchGeo(e){navigator.geolocation.getCurrentPosition(makeColor,errorFeedback,{timeout:3e4,maximumAge:6e5}),userFeedback(),domColorvalue.className="color txt-small notranslate",domColorvalue.textContent="Finding…",domOutput.appendChild(domColorvalue)}function errorFeedback(e){!1===window.isSecureContext||0==e.message.indexOf("Only secure origins are allowed")?userFeedback("Browser prevents geolocation use via non-secure (HTTP) page"):(alert("Error - "+e.message),userFeedback("Geolocation failed! Check settings and signal. Reload page and try again"))}function makeHue(e){return e.coords.longitude>0?Math.round(e.coords.longitude):Math.round(e.coords.longitude- -360)}function makeSat(e){return e.coords.latitude>0?Math.round((180-Math.round(e.coords.latitude)-90)/lightUnit):Math.round((180-(Math.round(e.coords.latitude)- -90))/lightUnit)}function makeColor(e){userFeedback();var o="HSLA("+makeHue(e)+", "+makeSat(e)+"%, 50%, 1)";domColorvalue.textContent=o,domOutput.style.backgroundColor=o,domOutput.appendChild(domColorvalue),domOutput.focus()}navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(function(e){function o(){"denied"===e.state&&userFeedback("Geolocation required. Allow location when prompted by your browser"),"prompt"===e.state?userFeedback("App requires geolocation. Allow location when prompted by your browser"):"granted"===e.state&&userFeedback()}o(),e.addEventListener("change",o,!1)}),"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js",{scope:"./"}).then(function(e){console.log("Service Worker Registered!"),domFooter.textContent+=" • Available Offline"}).catch(function(e){console.log("Registration failed with "+e)}),domButton.addEventListener("click",fetchGeo,!1)}else userFeedback("This app uses features not supported by your browser"),domOutput.focus();